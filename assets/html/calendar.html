{{ define "calendar" }}
{{ if eq .CalendarView "month" }}
    {{ template "month" . }}
{{ else }}
    {{ errorf "invalid view for calendar: %s" .View }}
{{ end }}
{{ end }}

{{ define "month" }}
<div id="calendar">
    <div class="calendar-title">{{ .Title }}</div>
    <div class="calendar-dow">Monday</div>
    <div class="calendar-dow">Tuesday</div>
    <div class="calendar-dow">Wednesday</div>
    <div class="calendar-dow">Thursday</div>
    <div class="calendar-dow">Friday</div>
    <div class="calendar-dow">Saturday</div>
    <div class="calendar-dow">Sunday</div>
    {{ range $i, $day := .Days }}
        <div class="day day-{{ $day.Weekday }}{{ if $day.Today }} day-today{{ end }}{{ if $day.Spill }} day-spill{{ end }}">
            <div class="day-head">{{ $day.Number }}</div>
            {{ range $day.Events }}
                <div class="day-event">
                    <span class="event-time">{{ formatTime "15:04" .StartTime }}</span><span class="event-summary">{{ .Summary }}</summary>
                </div>
            {{ end }}
        </div>
    {{ end }}
</div>
{{ if .Cache }}
<input id="ical-cache" name="ical-cache" data-hx-swap-oob="true" value="{{ .Cache.Encode }}" type="hidden">
{{ end }}
{{ with .Error }}
<div id="error" class="input-group error" data-hx-swap-oob="true">
    <span id="error-label" class="input-group-text notification error">{{ . }}</span>
</div>
{{ else }}
{{ template "_placeholder-error" . }}
{{ end }}
{{ with .URL }}
<div id="url" class="input-group url" data-hx-swap-oob="true">
    <div class="input-group-prepend">
        <span id="url-label" class="input-group-text url">Your URL</span>
    </div>
    <input type="text" id="url-box" class="form-control url" disabled="disabled" value="{{ . }}">
    <div class="input-group-append">
        <button id="url-copy" class="btn btn-outline-secondary url" type="button"><i id="url-copy-icon" class="fa-regular fa-copy"></i> Copy</button>
    </div>
</div>
{{ else }}
{{ template "_placeholder-url" . }}
{{ end }}
{{ end }}

{{ define "_placeholder-error" }}
<div id="error" class="input-group no-error" data-hx-swap-oob="true"></div>
{{ end }}

{{ define "_placeholder-url" }}
<div id="url" class="input-group no-url" data-hx-swap-oob="true"></div>
{{ end }}
