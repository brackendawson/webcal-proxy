{{ define "calendar" }}
{{ if eq .View "month" }}
    {{ template "month" . }}
{{ else }}
    {{ errorf "invalid view for calendar: %s" .View }}
{{ end }}
{{ end }}

{{ define "month" }}
<div id="calendar">
    <div class="calendar-title">{{ .Title }}</div>
    <div class="calendar-dow">Monday</div>
    <div class="calendar-dow">Tuesday</div>
    <div class="calendar-dow">Wednesday</div>
    <div class="calendar-dow">Thursday</div>
    <div class="calendar-dow">Friday</div>
    <div class="calendar-dow">Saturday</div>
    <div class="calendar-dow">Sunday</div>
    {{ range $i, $day := .Days }}
        <div class="day day-{{ $day.Weekday }}{{ if $day.Today }} day-today{{ end }}{{ if $day.Spill }} day-spill{{ end }}">
            <div class="day-head">{{ $day.Number }}</div>
            {{ range $day.Events }}
                <div class="day-event">
                    <span class="event-time">{{ formatTime "15:04" .StartTime }}</span><span class="event-summary">{{ .Summary }}</summary>
                </div>
            {{ end }}
        </div>
    {{ end }}
</div>
{{ if .Cache }}
<input id="ical-cache" name="ical-cache" data-hx-swap-oob="true" value="{{ .Cache.Encode }}" type="hidden">
{{ end }}
{{ with .Error }}
<span id="error" class="notification error" data-hx-swap-oob="true">{{ . }}</span>
{{ else }}
<span id="error" class="notification no-error" data-hx-swap-oob="true"></span>
{{ end }}
{{ with .URL }}
<div id="url" class="notification url" data-hx-swap-oob="true"><label id="url-label" for="url-box">Your URL</label><input id="url-box" disabled="disabled" value="{{ . }}"></div>   
{{ else }}
<span id="url" class="notification no-url" data-hx-swap-oob="true"></span>
{{ end }}
{{ end }}
